### 数据库系统三级结构

| 层次 (Level)                  | 别称 (Also known as)         | 描述 (Description)                                           | 对应的模式 (Schema)                                          |
| ----------------------------- | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **外部层 (External Level)**   | 用户层 (User Level) / 子模式 | 描述特定用户能看到和使用的局部数据的逻辑结构和特征 。这是用户的数据视图 。 | **外模式 (External Schema)** 或 **子模式 (Subschema)**       |
| **概念层 (Conceptual Level)** | 逻辑层 (Logic Level)         | 描述数据库中全体数据的逻辑结构和特征，是数据库的总体视图 。它定义了存储哪些数据以及数据间的关系 。 | **概念模式 (Conceptual Schema)** 或 **模式 (Schema)**        |
| **内部层 (Internal Level)**   | 物理层 (Physical Level)      | 描述数据在计算机上的物理表示，即数据是如何在数据库中存储的 。 | **内模式 (Internal Schema)** 或 **存储模式 (Storage Schema)** |





### 各种码的关系

> ### 1. 超码 (Super Key)
>
> - 定义：在一个关系中，能唯一标识一个元组的属性或属性集被称为超码
>
> - **核心特点**：“能用就行，可能包含多余信息”。
>
> - 举例：在关系 
>
>   ```
>   学生(学号, 姓名, 身份证号, 专业)
>   ```
>
>    中：
>
>   - `{身份证号}` 是一个超码。
>   - `{学号}` 也是一个超码。
>   - 因此，`{学号, 姓名}`、`{身份证号, 专业}` 这种包含了唯一标识属性的组合，也都是超码。
>
> ### 2. 候选码 (Candidate Key)
>
> - 定义：不含有多余属性的超码，也就是最小的超码
>
>   。从超码中去掉任何一个属性，它就不再是超码了。
>
> - **核心特点**：“刚刚好，不多也不少”。
>
> - 举例：在关系 
>
>   ```
>   学生(学号, 姓名, 身份证号, 专业)
>   ```
>
>    中：
>
>   - `{学号, 姓名}` 是超码，但不是候选码，因为去掉 `姓名` 后，`{学号}` 仍然是超码。
>   - `{学号}` 是候选码。
>   - `{身份证号}` 也是候选码。
>   - 这个关系有两个候选码：`{学号}` 和 `{身份证号}`。
>
> ### 3. 主码 (Primary Key)
>
> - 定义：数据库设计者从一个关系的多个候选码中选出的一个，作为该关系元组的唯一标识
> - **核心特点**：“官方指定，唯一代表”。
> - 规则：
>   - 一个关系只能有一个主码
>   - 主码中的所有属性都不能为空值 (NULL)，这被称为实体完整性约束 (Entity Integrity)
> - **举例**：对于 `学生` 关系，我们可以从 `{学号}` 和 `{身份证号}` 这两个候选码中选择 `{学号}` 作为主码。
>
> ### 4. 备选码 (Alternate Key)
>
> - 定义：候选码中未被选为主码的其他候选码
> - **核心特点**：“候补选手”。
> - **举例**：在 `学生` 关系中，如果我们选了 `{学号}` 作为主码，那么 `{身份证号}` 就成为备选码。
>
> ### 它们之间的关系
>
> 范围关系：超码 > 候选码 > 主码
>
> 您可以这样理解：
>
> - 所有能唯一标识一行的属性组合都是**超码**。
> - 从中挑出那些最简洁、没有冗余属性的组合，就是**候选码**。
> - 再从这些候选者中，指定一个官方的、最常用的，就是**主码**。
> - 剩下的候选者就成了**备选码**。
>
> ------
>
> ### 其他重要的概念
>
> - **外码 (Foreign Key)**
>   - 定义：一个关系 R 中的属性（或属性组）X 不是 R 的码，但它与另一个关系 S 的主码相对应
>   - 作用：外码是用来建立和加强两个关系之间联系的。它确保了参照完整性 (Referential Integrity)，即外码的值要么必须是其引用的主码值，要么为空
>   - **举例**：`选课(学号, 课程号, 成绩)` 关系中，`学号` 是外码，参照 `学生` 表的主码；`课程号` 也是外码，参照 `课程` 表的主码。
> - **主属性 (Prime Attribute) 与 非主属性 (Non-prime Attribute)**
>   - 定义：含在任何一个候选码中的属性，称为主属性；不包含在任何候选码中的属性，称为非主属性 9
>   - 这个概念在**规范化理论（如第二范式、第三范式）**中至关重要。
>
> ### 总结表格
>
> 为了方便您区分，这里用表格总结一下：
>
> | **码的类型**               | **定义**               | **唯一性** | **最小性** | **是否可为NULL**  | **数量** |
> | -------------------------- | ---------------------- | ---------- | ---------- | ----------------- | -------- |
> | **超码 (Super Key)**       | 能唯一标识元组的属性集 | 是         | 不一定     | 可以              | 多个     |
> | **候选码 (Candidate Key)** | 最小的超码             | 是         | 是         | 否                | 多个     |
> | **主码 (Primary Key)**     | 被选中的一个候选码     | 是         | 是         | 否 (实体完整性)   | 唯一     |
> | **备选码 (Alternate Key)** | 未被选中的候选码       | 是         | 是         | 否                | 多个     |
> | **外码 (Foreign Key)**     | 参照另一关系主码的属性 | 否         | 不适用     | 可以 (参照完整性) | 多个     |





### ORDER BY和 GROUP BY

| 特性                 | `GROUP BY`                                         | `ORDER BY`                                         |
| -------------------- | -------------------------------------------------- | -------------------------------------------------- |
| **目的**             | **数据聚合**，按组进行统计计算                     | **数据排序**，改变结果的显示顺序                   |
| **对行的影响**       | **改变行数**，多行数据被合并成一行                 | **不改变行数**，只是重新排列行                     |
| **与聚合函数的关系** | **几乎总是**与聚合函数（`SUM`, `COUNT`等）一起使用 | **可以**对聚合函数的结果进行排序，但本身不执行聚合 |
| **在查询中的位置**   | 在 `WHERE` 之后，`ORDER BY` 之前                   | **总是**在查询语句的**最后**                       |





### SQL查询书写顺序

`FROM` -> `WHERE` -> `GROUP BY` -> `HAVING` -> `SELECT` -> `ORDER BY`





### 关系模式和关系

| 对比项   | **关系模式 (Relational Schema)**  | **关系 (Relation)**                                  |
| -------- | --------------------------------- | ---------------------------------------------------- |
| **比喻** | 表格的**表头** / 房子的**设计图** | **整个表格** (包含表头和所有数据行) / **建好的房子** |
| **本质** | 对表的**结构描述** (Blueprint)    | 表在某一时刻的**实例和数据** (Instance)              |
| **特性** | **静态的、稳定的**                | **动态的、可变的**（数据会增删改）                   |





### "", '', ``

| 符号      | 名称                  | 主要用途                      | 示例                                 | 推荐度               |
| --------- | --------------------- | ----------------------------- | ------------------------------------ | -------------------- |
| **```**   | 反引号 (Backtick)     | **标识符** (数据库、表、列名) | `SELECT \`id`, `name` FROM `users`;` | ⭐⭐⭐⭐⭐ **(强烈推荐)** |
| **`' '`** | 单引号 (Single Quote) | **字符串常量**                | `WHERE \`name` = '张三';`            | ⭐⭐⭐⭐⭐ **(强烈推荐)** |
| **`" "`** | 双引号 (Double Quote) | 默认是字符串，但行为可变      | `WHERE \`name` = "张三";`            | ⭐ **(不推荐使用)**   |



### 
